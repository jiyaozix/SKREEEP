--[[ 
Chat Logs Design by dollar#0007
--]]

for i, v in pairs(game.CoreGui:GetChildren()) do
   if v.Name == "WhisperSpy" then
       v:Destroy()
   end
end

local ScreenGui = Instance.new("ScreenGui")
local TabContainer = Instance.new("Frame")
local ChatTab = Instance.new("TextButton")
local JoinTab = Instance.new("TextButton")
local Scroll = Instance.new("ScrollingFrame")
local ClearButton = Instance.new("TextButton")
local SaveButton = Instance.new("TextButton")

ScreenGui.Name = "WhisperSpy"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

TabContainer.Name = "TabContainer"
TabContainer.Parent = ScreenGui
TabContainer.Size = UDim2.new(0, 405, 0, 40)
TabContainer.Position = UDim2.new(0.0159817338, 0, 0.631728053, 0)
TabContainer.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
TabContainer.BackgroundTransparency = 0.5

ChatTab.Name = "ChatTab"
ChatTab.Parent = TabContainer
ChatTab.Size = UDim2.new(0, 202, 0, 40)
ChatTab.Text = "Chat Logs"
ChatTab.Font = Enum.Font.SourceSans
ChatTab.TextSize = 20
ChatTab.TextColor3 = Color3.fromRGB(255, 255, 255)
ChatTab.BackgroundTransparency = 1
ChatTab.TextButton = true

JoinTab.Name = "JoinTab"
JoinTab.Parent = TabContainer
JoinTab.Size = UDim2.new(0, 202, 0, 40)
JoinTab.Position = UDim2.new(0, 202, 0, 0)
JoinTab.Text = "Join Logs"
JoinTab.Font = Enum.Font.SourceSans
JoinTab.TextSize = 20
JoinTab.TextColor3 = Color3.fromRGB(255, 255, 255)
JoinTab.BackgroundTransparency = 1
JoinTab.TextButton = true

Scroll.Name = "Scroll"
Scroll.Parent = ScreenGui
Scroll.BackgroundColor3 = Color3.new(0.337255, 0.337255, 0.337255)
Scroll.BackgroundTransparency = 0.89999997615814
Scroll.Position = UDim2.new(0.0159817338, 0, 0.731728053, 0)
Scroll.Size = UDim2.new(0, 405, 0, 222)
Scroll.CanvasSize = UDim2.new(0, 0, 1, 0)
Scroll.ScrollBarThickness = 10

ClearButton.Name = "ClearButton"
ClearButton.Parent = ScreenGui
ClearButton.Size = UDim2.new(0, 100, 0, 50)
ClearButton.Position = UDim2.new(0, 0, 0.955, 0)
ClearButton.Text = "Clear"
ClearButton.Font = Enum.Font.SourceSans
ClearButton.TextSize = 20
ClearButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ClearButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ClearButton.TextButton = true

SaveButton.Name = "SaveButton"
SaveButton.Parent = ScreenGui
SaveButton.Size = UDim2.new(0, 100, 0, 50)
SaveButton.Position = UDim2.new(0, 305, 0.955, 0)
SaveButton.Text = "Save To.txt"
SaveButton.Font = Enum.Font.SourceSans
SaveButton.TextSize = 20
SaveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SaveButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
SaveButton.TextButton = true

function SCRIPT_KTFX73_FAKESCRIPT()
    local script = Instance.new('LocalScript')
    script.Parent = ScreenGui

    local plr = game.Players.LocalPlayer
    local Scroll = script.Parent.Scroll

    local textnumber = 1
    local prevOutputPos = 0

    -- Output message function
    function output(plr, msg)
        local colour = Color3.fromRGB(255, 255, 255)
        local labels = Scroll:GetChildren()

        -- Check for different command types (whisper changes color)
        if string.sub(msg, 1, 2) == "+e" or string.sub(msg, 1, 2) == "+w" or string.sub(msg, 1, 2) == "+t" or string.sub(msg, 1, 8) == "+console" or string.sub(msg, 1, 5) == "+team" then
            colour = Color3.fromRGB(255, 255, 0) -- yellow for normal commands
        elseif string.sub(msg, 1, 8) == "+whisper" then
            colour = Color3.fromRGB(0, 255, 255) -- change color for whisper (cyan)
        else
            colour = Color3.fromRGB(255, 255, 255) -- default white for regular chat
        end

        -- Create new label for the message
        local o = Instance.new("TextLabel", Scroll)
        o.Name = textnumber
        textnumber = textnumber + 1
        o.Text = plr.Name .. ": " .. msg
        o.Size = UDim2.new(0.95, 0, .02, 0)
        o.Position = UDim2.new(0, 0, .02 + prevOutputPos, 0)
        o.Font = Enum.Font.SourceSansBold
        o.TextColor3 = colour
        o.TextStrokeTransparency = 0
        o.BackgroundTransparency = 1
        o.BackgroundColor3 = Color3.new(0, 0, 0)
        o.BorderSizePixel = 0
        o.BorderColor3 = Color3.new(0, 0, 0)
        o.FontSize = "Size14"
        o.TextXAlignment = Enum.TextXAlignment.Left
        o.ClipsDescendants = true
        prevOutputPos = prevOutputPos + 0.025

        -- Auto-scroll to the bottom every time a message is added
        Scroll.CanvasPosition = Vector2.new(0, Scroll.CanvasSize.Y.Offset)
    end

    -- Listen to player's chat messages
    for i, v in pairs(game.Players:GetChildren()) do
        v.Chatted:Connect(function(msg)
            output(v, msg)
        end)
    end

    -- New player joined
    game.Players.ChildAdded:Connect(function(plr)
        if plr:IsA("Player") then
            plr.Chatted:Connect(function(msg)
                output(plr, msg)
            end)
        end
    end)

    -- Listen for +clear command
    plr.Chatted:Connect(function(msg)
        if msg == "+clear" then
            for i, v in pairs(Scroll:GetChildren()) do
                if v:IsA("TextLabel") then
                    prevOutputPos = 0
                    v:Destroy()
                    textnumber = 1
                end
            end
        end
    end)
end

coroutine.resume(coroutine.create(SCRIPT_KTFX73_FAKESCRIPT))

-- Add function to clear logs
ClearButton.MouseButton1Click:Connect(function()
    for _, v in pairs(Scroll:GetChildren()) do
        if v:IsA("TextLabel") then
            v:Destroy()
        end
    end
end)

-- Add function to save logs to a text file
SaveButton.MouseButton1Click:Connect(function()
    local logs = ""
    for _, v in pairs(Scroll:GetChildren()) do
        if v:IsA("TextLabel") then
            logs = logs .. v.Text .. "\n"
        end
    end
    writefile("logs.txt", logs)
end)
